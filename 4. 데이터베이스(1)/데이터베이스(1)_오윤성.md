# 4. 데이터베이스

DB, DataBase는 일정한 규칙, 혹은 규약을 통해 구조화되어 저장되는 데이터 모음입니다.
해당 데이터베이스를 제어, 관리하는 통합 시스템을 DBMS(DataBase Management System)라고 하며, 데이터베이스 안에 있는 데이터들은 특정 DBMS마다 정의된 쿼리 언어를 통해 삽입, 삭제, 수정 조회 등을 수행할 수 있습니다. 

### 🍔 Entity, 엔터티
사람, 장소, 물건, 사건, 개념 등 여러 개의 속성을 지닌 **명사**를 의미합니다. 

### 약한 엔터티와 강한 엔터티
엔터티는 `약한 엔터티`, `강한 엔터티`로 크게 두 가지로 나뉩니다.
A가 혼자서는 존재하지 못하고 B의 존재 여부에 따라 종속적이라면 A는 약한 엔터티이고 B는 강한 엔터티가 됩니다. 
즉, B가 있어야 A가 존재할 수 있을 때
약한 엔터티 : A
강한 엔터티 : B

### 🍟 Relation, 릴레이션
>데이터베이스에서 정보를 구분하여 저장하는 기본 단위입니다. 엔터티에 관한 데이터를 데이터베이스는 릴레이션 하나에 담아서 관리합니다.

#### 테이블과 컬렉션
데이터 베이스는 크게 `관계형 데이터베이스`와 `NoSQL 데이터베이스`로 나눌 수 있습니다. 
이 중 대표적인 관계형 데이터베이스인 MySQL과 대표적인 NoSQL 데이터베이스인 MongoDB가 있습니다.

`MySQL`의 구조 : 레코드-테이블-데이터베이스
`NoSQL`의 구조 : 도큐먼트-컬렉션-데이터베이스

릴레이션은 데이터베이스 종류에 따라 다르게 불리는데!
관계형 데이터베이스 : `테이블`
NoSQL 데이터베이스 : `컬렉션`
이라고 불립니다.😊

### 🍿 Attribute, 속성
>릴레이션에서 관리하는 구체적이며 고유한 이름을 갖는 정보입니다.

![](https://velog.velcdn.com/images/oyunseong/post/dc594fcc-468e-43f2-9b71-3b87c35bbe66/image.png)

예를 들어 고양이의 엔터티의 속성을 생각해보겠습니다.

품종, 털 색상, 동공 색상 등이 있을 수 있습니다. 

고양이의 특징들을 엔터티의 속성이라고 할 수 있습니다.🐱

### 🍖 Domain, 도메인
> 릴레이션에 포함된 각각의 속성들이 가질 수 있는 값의 집합을 말합니다.

예를 들어 학생이라는 릴레이션에 성별이라는 속성이 있다면 이 속성을 가질 수 있는 값은 {남, 여}라는 집합이 됩니다. 

![](https://velog.velcdn.com/images/oyunseong/post/4d0abd30-e8db-48f2-86a2-6cc81e441c32/image.png)

### 🍗 필드와 레코드
![](https://velog.velcdn.com/images/oyunseong/post/1f08fa9c-a543-4939-87eb-933303997539/image.png)
학생이라는 테이블에 4개의 속성이 있습니다. 

이 테이블에 쌓는 행(row) 단위의 데이터를 레코드 또는 튜플이라고 합니다. 

### 🥩 필드 타입
각 필드에는 다양한 타입으로 선언할 수 있습니다. 
#### 숫자 타입
`TINYINT`, `SMALLINT`, `MEDIUMINT`, `INT`, `BIGINT` 등이 있습니다.

|타입|용량(바이트)|최소값(부호 있음)|최솟값(부호 없음)|최댓값(부호 없음)|최댓값(부호 있음)
|--|--|--|--|--|--|
|TINYINT|1|-128|0|127|255|
|SMAILLINT|2|-32768|0|32767|65535|
|MEDIUMINT|3|-8388608|0|8388607|16777215|
|INT|4|-2147483648|0|2147483648|4294967295|
|BIGINT|5|-263|0|263-1|264-1|

여기서 부호 있음 없음의 의미는 signed, unsigned입니다. 

#### 날짜 타입
`DATE`, `DATETIME`, `TIMESTAMP` 등이 있습니다.

#### DATE
날짜 부분은 있지만 시간 부분이 없는 값에 사용됩니다. 
지원되는 범위는 1000-01-01 ~ 9999-12-31 입니다.
3바이트의 용량으로 가장 작은 용량을 갖습니다 .

|타입|DATE|DATETIME|TIMESTAMP|
|--|--|--|--|
|지원되는 범위|1000-01-01 ~ 9999-12-31|1000-01-01 00:00:00 ~ 9999-12-31 23:59:59| 1970-01-01 00:00:01 ~ 2023-01-19 03:14:07|
|용량(BYTE)| 3 | 8|4|

#### 문자 타입
`CHAR`, `VARCHAR`, `TEXT`, `BLOB`, `ENUM`, `SET` 이 있습니다.

#### CHAR와 VARCHAR
CHAR는 테이블을 생성할 때 선언한 길이로 고정되며 

|타입|CHAR|VARCHAR|
|--|--|--|
|길이|고정(0~255)|가변(0~65,535)|

VARCHAR는 가변 길이 문자로 입력된 데이터에 따라 용량을 가변시켜 저장합니다. 길이 기록용 1바이트를 추가로 할당하기 때문에 지정된 형태에 따라 저장된 CAHR의 경우 검색에 유리합니다. 
검색을 별로 하지 않고 유동적인 길이를 가진 데이터는 VARCHAR로 저장하는 것이 좋습니다. 

 ***검색을 많이 하는 경우 `CHAR` 타입 사용***

#### TEXT와 BLOB
>큰 데이터를 저장할 때 쓰는 타입입니다.

TEXT는 큰 문자열 저장에 쓰며 주로 게시판의 본문을 저장할 때 사용합니다.
BLOB는 이미지, 동영상 등 큰 데이터 저장에 씁니다. 그러나 보통은 DB에 주소값을 VARCHAR로 저장하고 영상은 클라우드, AWS나 다른 플랫폼에 저장합니다.

#### ENUM과 SET
>두 타입 모두 문자열을 열거한 타입입니다. 

ENUM은 (x-small, small, medium, large, x-large) 형태로 쓰이며, 이 중에서 하나만 선택하는 단일 선택만 가능하고 ENUM 리스트에 없는 잘못된 값을 삽입하면 빈 문자열이 대신 삽입됩니다. ENUM을 이용하면 x-small 등이 0,1 등으로 매핑되어 **메모리를 적게 사용**하는 이점을 얻습니다. 최대 65,535개의 요소들을 넣을 수 있습니다.

SET은 ENUM과 비슷하지만 여러 개의 데이터를 선택할 수 있고 비트 단위의 연산을 할 수 있으며 최대 64개의 요소를 넣을 수 있습니다. 


### 🍘 관계

#### 1:1 관계
예를 들어 유저당 유저 이메일은 한 개씩 있을 때 이 관계를 1:1관계라고 합니다.

#### 1:N 관계
예를 들어 쇼핑몰에서 한 유저당 여러 개의 상품을 장바구니에 넣는 상황을 생각해 보겠습니다.
이 경우 유저 1명당 여러 개의 상품을 담을 수 있으니 1:N 관계가 됩니다.

***한 개체가 다른 많은 개체를 포함하는 관계***

#### N:M 관계
이 관계는 1:N과 1:M이라는 관계를 갖는 테이블 두 개로 나눠서 설정합니다.

### 🍚 Key, 키
테이블 간의 관계를 조금 더 명확하게 하고 테이블 자체의 인덱스를 위해 설정된 장치입니다.

#### PK, 기본키 
한 릴레이션에서 특정 튜플을 유일하게 구별할 수 있는 속성입니다. 
Primary Key는 `유일성`과 `최소성`을 만족합니다.

`유일성` : 하나의 키값으로 튜플을 유일하게 식별할 수 있는 성질

여러 개의 튜플이 존재할 때 각각의 튜플을 유일하게 서로 구분될 수 있어야합니다. 예를 들어 (주민번호, 이름, 성별)이라는 속성이 있을 때 이름과 성별은 중복될 수 있는 속성입니다. 하지만 주민번호는 모두 다르기 때문에 절대 중복할 수 없습니다. 즉, 각각의 튜플을 구분할 수 있는 성질을 유일성이라고 합니다.

`최소성` : 꼭 필요한 최소한의 속성들로만 키를 구성하는 성질

튜플을 구분하는데 진짜 필요한 속성으로만 구성되어있는 지를 의미합니다. 즉, 굳이 없어도 될 속성들을 넣지 말자는 뜻입니다. 예를 들어 다음과 같은 속성(주민번호, 이름, 성별)이 있다면, 물론 현재의 속성들은 튜플을 구분할 수 있습니다. 주민번호, 이름, 성별이 모두 같은 사람을 없으니까요. 생각해보면 이름, 성별을 빼도 주민번호만으로 각 튜플을 유일하게 식별할 수 있습니다. 이때 이름, 성별을 빼면 해당 키는 최소성을 만족합니다.

***한마디로 😎
유일성은 중복안되고 그 속성 하나로만 구분할 수 있는지
최소성은 진짜 필요한 것인가?를 구분하는 성질입니다.***

#### 자연키
예를 들어 유저 테이블을 만든다고 가정하면 주민등록번호, 이름, 성멸 등의 속성이 있습니다.
이름과 성별은 중복될 수 있지만 주민번호는 중복되지 않습니다. 이런 식으로 중복되는 값들을 제외하고 자연스럽게 나오는 키를 뽑는 것을 `자연키`라고 합니다.
자연키는 언젠가 변하는 속성을 갖습니다.

#### 인조키
인위적으로 유저 아이디를 부여해서 고유 식별자를 생성하는 키입니다.
이렇게 인위적으로 생성한 키를 `인조키`라고합니다. 
보통 기본키는 인조키로 설정합니다.

#### FK, 외래키
Foreign Key, 테이블의 기본키를 그대로 참조하는 값으로 개체와의 관계를 식별하는 데 사용합니다.
외래키는 중복되어도 됩니다.

#### CK, 후보키 
Candidate Key, 기본키가 될 수 있는 후보들이며 `유일성`과 `최소성`을 동시에 만족합니다.

#### AK, 대체키
Alternate Key, 후보키가 두 개 이상일 경우 어느 하나를 기본키로 지정하고 남은 후보키들을 말합니다. 

#### SK, 슈퍼키
Super Key, 각 레코드를 유일하게 식별할 수 있는 `유일성`을 갖춘 키입니다.