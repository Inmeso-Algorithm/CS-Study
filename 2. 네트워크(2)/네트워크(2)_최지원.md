# 2.3 네트워크 기기
## 2.3.1 네트워크 기기의 처리범위
네트워크를 구축하는데 있어 다양한 요구사항을 처리하는 기기들이 있습니다. 이들을 OSI 7 layer에 따른 각 계층별로 분류할 수 있습니다. 예를 들어, 물리 계층을 처리하는 기기가 있고 데이터 링크 계층을 처리하는 기기가 있습니다.    
      
상위 계층을 처리하는 기기는 하위 계층을 처리할 수 있지만 그 반대는 불가능합니다. 애플리케이션 계층을 담당하는 기기는 그 하위 계층을 처리 할 수 있지만, 물리 계층을 담당하는 기기가 상위 계층을 담당할 수 는 없다는 뜻입니다.

---

## 2.3.2 애플리케이션 계층을 처리하는 기기
애플리케이션 계층을 처리하는 기기로 L7 스위치가 있습니다

L7 스위치의 주된 역할은 로드 밸런싱(Load balancing)입니다. 클라이언트의 요청을 여러 서버로 나누는 역할을 담당하는 기기이며, 필터링이 가능하고 트래픽 모니터링도 가능합니다.

### L4 스위치와 L7 스위치의 차이
L7 스위치 뿐만 아니라 L4 스위치 역시 로드 밸런싱을 할 수 있습니다. L4 스위치는 인터넷 계층에서 IP와 포트(Port) 기반으로 트래픽을 분산시킵니다. L7 스위치는 이것에 추가로 HTTP/HTTPS 와 같은 상위 계층 프로토콜을 기반으로 로드 밸런싱을 수행 할 수 있다는 차이점이 있습니다.

---

## 2.3.3 인터넷 계층을 처리하는 기기
인터넷 계층을 처리하는 기기로 L3 스위치와 라우터가 있습니다. 이 두개는 사실상 거의 동일한 의미를 가지고 있습니다.
### 라우터
라우터(Router)는 라우팅(Routing)을 해주는 장비입니다. 라우팅이란, 네트워크 상에서 데이터의 이동할 때 최적의 경로를 선택하는 과정입니다. 즉, 라우터는 어떠한 데이터가 목적지로 이동 할 때 가장 최적의 경로로 가기위한 다음 노드로 데이터를 보내는 일을 담당하는 장치라 할 수 있습니다.

---

## 2.3.4 데이터 링크 계층을 처리하는 기기
데이터 링크 계층을 처리하는 기기로 L2 스위치와 브리지가 있습니다.
### 브리지
브리지는 MAC주소를 기반으로 이를 테이블로 관리하여 데이터를 보내는 역할을 하는 장치입니다.

---

## 2.3.5 물리 계층을 처리하는 기기
물리 계층을 처리하는 기기는 NIC, 리피터, AP가 있습니다.
### NIC
LAN 카드라고도 하며 각 NIC마다 고유의 식별번호인 MAC주소가 있습니다.
### 리피터
리피터는 약해진 신호정보를 증폭시키는 역할을 하는 장치입니다. 현재는 광케이블의 보급으로 잘 쓰이지 않는 장치입니다.
### AP
AP(Access Point)는 패킷을 복사하는 기기입니다. 


# 2.4 IP 주소
## 2.4.1 ARP
컴퓨터와 컴퓨터 사이의 통신은 IP주소를 기반으로 통신한다고 알려져 있지만, 사실은 ARP(Address Resolution Protocol)를 통해 MAC주소를 알아내 통신하는 과정이 있습니다.   

ARP는 IP주소를 가지고 MAC주소를 알아내게 해주는 프로토콜입니다. ARP를 통해 논리적 주소인 IP를 가지고 물리적 주소인 MAC주소를 알아내 데이터를 전달하는 것입니다.

---

## 2.4.2 홉바이홉 통신
IP주소를 통해 통신하는 과정을 홉바이홉(Hop by hop) 통신이라고 합니다. 홉(Hop)은 건너뛰는 것을 의미합니다. 이것은 마치 데이터가 각 라우터를 건너서 목적지에 도달하는 과정을 비유적을 표현한 것입니다.

### 라우팅 테이블
라우팅 테이블은 송신지부터 수신지까지 도달하기 위해 사용되는 테이블로 라우터안에 있으며 데이터가 목적지에 도달하기 위해 거쳐가야 할 다음 라우터에 대한 정보 등이 담겨져 있습니다.

### 게이트웨이
게이트웨이(gateway)의 사전적 의미는 관문이라는 뜻을 가지고 있습니다. 여기서는 서로 다른 통신망이나 프로토콜을 사용하는 네트워크 간의 통신을 가능하게 하는 역할을 하는 컴퓨터 또는 소프트웨어를 뜻하는 의미로 쓰입니다.

### **라우팅과 포워딩의 차이점**   

라우팅(Routing)은 패킷이 출발지로부터 목적지로 가는 경로를 설정하는 것이고, 포워딩(Fowarding)은 노드에서 패킷을 알맞는 포트로 출력되도록 설정하는 것을 의미합니다.   


![image](https://cdn.discordapp.com/attachments/1004705939779244176/1008651480309448765/unknown.png)
위 그림은 라우팅 프로토콜 중 하나인 RIP(Routing Information Protocol)의 거리 벡터 라우팅 방법을 설명한 그림입니다. 네트워크 망과 라우터를 노드와 그 노드들의 연결(Edge)의 집합으로 표현하고, 벨만-포드 알고리즘으로 출발지에서 목적지까지의 최소 비용(또는 시간) 경로를 계산합니다.   

![image](https://cdn.discordapp.com/attachments/1004705939779244176/1008655560897470484/unknown.png)   
위 그림은 A 컴퓨터에서 B 컴퓨터로 데이터를 보내는 상황에서의 라우팅 테이블 작성 방법에 따른 두 가지 예시를 보여줍니다. A 컴퓨터에서 보낸 데이터가 라우팅 테이블을 토대로 다음 합인 R1으로 보내주게 하는 것이 포워딩입니다.

---

## 2.4.3 IP 주소 체계
IP 주소는 IPv4와 IPv6으로 나뉘는데, 현재 가장 보편적으로 쓰이는 것은 IPv4입니다.

### 클래스 기반 할당 방식
IP 주소 체계를 구분하는 방식은 시간이 지남에 따라 다양하게 발전되어 왔으며 가장 먼저 쓰인 구분 방식은 클래스 기반 할당 방식입니다.   
클래스 기반 할당 방식은 0.0.0.0 부터 255.255.255.255 까지의 전체 IP 주소를 A, B, C, D, E의 클래스로 나누는 할당 방식입니다.   

### DHCP
DHCP(Dynamic Host Configuration Protocol)는 IP 주소 및 기타 통신 매개변수를 자동으로 할당하기 위한 네트워크 관리 프로토콜입니다.

### NAT
NAT(Network Address Translation)는 패킷이 라우팅 장치를 통해 전송되는 동안 패킷의 IP 주소 정보를 수정하여 IP 주소를 다른 주소로 매핑하는 방법입니다.   
IPv4에서의 주소 체계만으로는 많은 주소를 감당하기 어려운데, NAT를 이용함으로서 하나의 공인 IP로 여러 개의 사설 IP주소를 가짐으로서 이러한 문제점을 해결 할 수 있습니다.

#### **NAT의 장단점**
NAT를 이용하면 내부 네트워크의 IP 주소와 외부로 드러내는 IP 주소를 다르게 유지할 수 있어 보안 측면에서 이점을 가집니다. 하지만 여러 명이 동시에 접속하게 될 때 접속 속도가 느려질 수 있습니다.

### IP주소를 이용한 위치 정보
IP 주소는 인터넷에서 사용하는 네트워크 주소이므로 이를 이용해 대략적인 위치를 알아낼 수 있습니다. 

# 2.5 HTTP
HTTP(HyperText Transfer Protocol)는 애플리케이션 계층의 프로토콜로서 웹 서비스 통신에 이용됩니다. HTTP는 기본적으로 TCP 프로토콜 서비스를 이용하지만, HTTP 자체는 상태가 존재하지 않는(Stateless) 프로토콜입니다. 이는 클라이언트에 대한 정보가 서버에 저장되어 있지 않는다는 뜻입니다.

## 2.5.1 HTTP/1.0
HTTP의 가장 초기 버전인 HTTP/1.0은 기본적으로 하나의 요청에 하나의 TCP 연결을 처리하도록 설계되었습니다. 이것을 비영속적 연결(nonpersistent connection)이라고 하는데, 하나의 파일을 불러올때마다 각각의 TCP 연결과정을 거쳐야 하므로 큰 오버헤드가 발생합니다.   

비영속적 연결의 문제점
- 3-way handshake 과정에서의 오버헤드
- 서버에서 각각의 연결마다 버퍼를 할당해주어야 함
- Slow start로 인한 지연
- TCP socket 생성에서의 OS 오버헤드

이러한 문제를 해결하고자 이미지 스플리팅, 코드 압축, 이미지 인코딩 등의 많은 방법이 시도되었습니다.

---

## 2.5.2 HTTP/1.1
HTTP/1.0에서 발전한 형태가 바로 HTTP/1.1입니다. HTTP/1.1에서의 가장 큰 차이점은 바로 영속적 연결(persistent connection)을 기본으로 규정하였다는 점입니다. 영속적 연결에서는, 하나의 요청으로 TCP 연결이 수립되고 데이터 전송이 끝나더라고, 서버에서는 이 연결을 바로 끊지 않고 유지합니다. 이러한 방식으로 HTTP/1.1에서는 비영속적 연결에서 발생했던 문제점을 해결하였습니다.

### HOL Blocking
HTTP/1.x 버전에서 발생하는 문제로 같은 큐에 있는 패킷이 그 첫 번째 패킷에 의해 지연될 때 발생하는 성능 저하 현상을 말합니다.   

![image](https://cdn.discordapp.com/attachments/1004705939779244176/1008671683038695536/unknown.png)
위 그림은 너무 큰 크기를 가진 O1로 인해 그 뒤에 O2, O3, O4도 대기중인 모습을 나타냅니다.

---

## 2.5.3 HTTP/2
HTTP/2는 기존의 HTTP/1.x보다 지연 시간을 더 줄이고 응답 시간을 더 빠르게 할 수 있으며, 멀티플렉싱, 헤더 압축, 서버 푸시, 요청의 우선순위 처리를 지원하는 프로토콜입니다.   

### 멀티플렉싱
멀티플렉싱이란 여러 개의 스트림을 사용하여 송수신한다는 것입니다. 이로인해 하나의 연결로 여러 요청을 병렬적으로 처리할 수 있게 되었고, 또한 각 스트림 내의 데이터들도 프레임이라는 작은 단위로 쪼개져서 HOL Blocking 문제를 해결할 수 있게 되었습니다.

### 헤더 압축
HTTP/1.x에서 존재하는 문제점 중 하나로 큰 크기의 헤더가 있었는데, HTTP/2에서는 허프만 코딩으로 헤더를 압축해 이를 해결하였습니다.

### 서버 푸시
기존의 HTTP/1.x에서는 클라이언트가 요청한 파일만을 보낼 수 있었다면, HTTP/2에서는 클라이언트가 요청하지 않은 파일에 대해서도 클라이언트에게 데이터를 보낼 수 있게 되었습니다.

---

## 2.5.4 HTTPS
HTTP/2는 HTTPS 위에서 동작합니다. HTTPS는 애플리케이션 계층과 전송 계층 사이에 신뢰 계층인 SSL/TLS을 넣은 신뢰할 수 있는 HTTP 요청을 말합니다. 이를 통해 통신을 "암호화" 합니다.

### **SSL/TLS**
SSL/TLS는 전송 계층에서 보안을 제공하는 프로토콜입니다. 공격자가 클라이언트로부터 서버인 척 하며 사용자 정보를 가로채는 네트워크 상의 "인터셉터"를 SSL/TLS를 통해 방지할 수 있습니다.   

SSL/TLS는 보안 세션을 기반으로 데이터를 암호화하며 보안 세션이 만들어질 때 인증 메커니즘, 키 교환 암호화 알고리즘, 해싱 알고리즘이 사용됩니다.

#### 보안 세션
보안 세션이란 보안이 시작되고 끝나는 동안 유지되는 세션을 말하고, SSL/TLS는 핸드셰이크를 통해 보안 세션을 생성하고 이를 기반으로 상태 정보 등을 공유합니다.



---

## 2.5.5 HTTP/3
HTTP/3는 구글에서 만든 QUIC 프로토콜에 기반하고 있으며, 기존의 HTTP 프로토콜이 TCP 기반이였던 점과 달리 QUIC는 UDP에 기반하고있습니다. 따라서 기존의 HTTP 프로토콜에서 사용하는 TCP의 3-way handshake과정을 거지지 않아 번거로움을 줄였다고 할 수 있습니다.   
또한 QUIC은 FEC(Forward Error Correction)이 적용되어 낮은 패킷 손실률을 유지하고 이는 비행기와 같은 열악한 네트워크 환경에서 뛰어난 성능을 보여줍니다.